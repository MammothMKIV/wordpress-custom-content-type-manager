#summary CCTM_Pagination class reference
#labels Function-Reference,Technical
#sidebar SidebarFunctionReference

= Introduction =

The CCTM_Pagination class is a library for generating pagination links in conjunction with the GetPostsQuery class.  You can see the results of this library when you pop up a  modal lightbox for a relation or image field: the pagination links at the bottom of those pages are generated using this class.

http://content.screencast.com/users/fireproofsocks/folders/Jing/media/f0d80440-d3d4-4f3d-a776-acbd94a48e9f/00000107.png


= Formatting Templates (tpls) =

Pagination links are generated by assembling together a series of formatting strings (a.k.a templates or "tpls" for short).

See the includes/CCTM_Pagination.conf.php for some examples.  The idea was to hard-code some variations in link styles in that file.

== firstTpl == 

Used to format the link that takes you back to the very first page of results.  

*Sample:*

{{{
<a href="[+base_url+]&offset=[+offset+]">&laquo; First</a> &nbsp;
}}}

== lastTpl ==

Used to format the link that takes you back to the very last page of results.  

*Sample:*

{{{
&nbsp;<a href="[+base_url+]&offset=[+offset+]">Last &raquo;</a>
}}}


== prevTpl ==

Used to format the link that takes you back one page.

*Sample:*

{{{
<a href="[+base_url+]&offset=[+offset+]">&lsaquo; Prev.</a>&nbsp;
}}}

== nextTpl ==

Used to format the link that takes you forward one page.

*Sample:*
{{{
&nbsp;<a href="[+base_url+]&offset=[+offset+]">Next &rsaquo;</a>
}}}

== currentPageTpl ==

Used to format the number representing the current page.  You don't need to link to the page you're already on.

*Sample:*
{{{
&nbsp;<span>[+page_number+]</span>&nbsp;
}}}

== pageTpl ==

Used to format the links that take you directly to a given page.

*Sample:*
{{{
&nbsp;<a href="[+base_url+]&offset=[+offset+]" [+extra+]>[+page_number+]</a>&nbsp;
}}}

== outerTpl ==

Wraps the final output.  This has a  couple special placeholders.

 * `[+content+]` : you *must* use this placeholder.  All other links and HTML will replace this placeholder.
 * `[+current_page+]` : contains the number of the current page. Useful for messaging the user.
 * `[+page_count+]` : shows the total number of pages in the result set. 
 * `[+first_record+]` : number representing the first record visible on this page. 
 * `[+last_record+]` : number representing the last record visible on this page. 
 * `[+record_count+]` : number representing the total number of records in the result set. 
 
*Sample:*

{{{
<div id="pagination">
	[+content+]<br/>
	Page [+current_page+] of [+page_count+]<br/>
	Displaying records [+first_record+] thru [+last_record+] of [+record_count+]
</div>
}}}

----

= Arguments =

It's important to review the arguments to the CCTM's [get_posts] function: some of those arguments directly affect pagination.


----

= Usage Example 1 =

This example creates a simple link for "Older posts" -- it uses only a small portion of the available formatting templates.

{{{
// Define the query
$args = array();
$args['post_type'] = array('my_post_type');
$args['search_columns'] = array('post_title', 'post_content','some_custom_field');
//$args['taxonomy'] = 'category';
//$args['taxonomy_slug'] = '';
$args['orderby'] = 'post_date';
$args['date_format'] = 'F j, Y';
$args['limit'] = 20;
$args['paginate'] = true;

// Read the offset variable (VERY IMPORTANT!)
if (isset($_GET['offset'])) {
	$args['offset'] = (int) $_GET['offset'];
}


// Pagination formatting
$tpls = array();
$tpls['prevTpl'] = '<div class="nav-next"><a href="[+base_url+]&[+offset_key+]=[+offset+]" [+extra+]>Newer posts <span class="meta-nav">&rarr;</span></a></div>';
$tpls['nextTpl'] = '<div class="nav-previous"><a href="[+base_url+]&[+offset_key+]=[+offset+]" [+extra+]><span class="meta-nav">&larr;</span> Older posts</a></div>';
$tpls['outerTpl'] = '<div id="nav-below" class="navigation">[+content+]</div>';
$Q->set_tpls($tpls);

$results = $Q->get_posts($args);

foreach ($results as $r) {
    // print out a bit about each post in the result set... 
}

print $Q->get_pagination_links();

}}}


= Usage Example 2=

IN PROGRESS...

{{{
<?php

// in your template file...

$tpls['firstTpl'] = '';
$tpls['lastTpl'] = '';
$tpls['prevTpl'] = '';
$tpls['nextTpl'] = '';
$tpls['currentPageTpl'] = '';
$tpls['pageTpl'] = '';
$tpls['outerTpl'] = '';


Example of Generated Links:

			<< First < Prev.  1 2 3 4 5  Next >  Last >>

Keys define which parameter to look for in the URL.
number_of_pagination_links_displayed controls whether you have something like
<<prev 1 2 3 next>> or 1 2 3 4 5 6 ... 

	Templates used for formatting are assembled in the following manner:
	
	E.g. if the current page is 3:
	
	<<First <<Prev 1 2 3 Next>> Last>>
	\_____/ \____/ ^ ^ ^ \____/ \____/
	   |       |   | | |    |      +----- lastTpl
	   |       |   | | |    +------------ nextTpl
	   |       |   | | +----------------- currentPageTpl
	   |       |   +-+------------------- pageTpl
	   |       +------------------------- prevTpl
	   +--------------------------------- firstTpl

\_________________________________________________/
                    |
                    +-------------------- outerTpl
}}}